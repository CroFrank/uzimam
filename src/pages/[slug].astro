---
import { supabase } from "../lib/supabase"

const { slug } = Astro.params

const { data, error } = await supabase
  .from("short_links")
  .select("original_url")
  .eq("slug", `https://www.uzimam.com/${slug}`)
  .single()
if (!data || error) {
  return Astro.redirect("/404")
}
console.log(data.original_url)
return Astro.redirect(encodeURI(data.original_url))
---
